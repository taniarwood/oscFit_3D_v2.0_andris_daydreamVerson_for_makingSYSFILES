from numpy import *
import pickle

def orderArray(xylist):
    xyout = zeros([xylist.shape[0]+1, xylist.shape[1]])

    one_point = xylist[0,:]
    xyout[0,:] = one_point
    xylist = delete(xylist, 0, axis = 0)

    for i in range(1, xylist.shape[0]+1):
        mindiff_index = sum((one_point - xylist)**2, axis = 1).argmin()
        one_point = xylist[mindiff_index, :]
        xyout[i,:] = one_point
        xylist = delete(xylist, mindiff_index, axis = 0)

    xyout[-1,:] = xyout[0,:]
    return xyout

t2k_future = array([0.3600786737707535, 2.4777638272960876,
0.3600786737707535, 2.4710440100712865,
0.3598190054278416, 2.463724358974359,
0.35968917125638566, 2.457012931034483,
0.3600786737707535, 2.4488441644562338,
0.3600786737707535, 2.443032187707228,
0.3598190054278416, 2.4377679114168878,
0.3608576787994891, 2.490637185013263,
0.36059801045657724, 2.483552433894231,
0.3598190054278416, 2.4320464190981435,
0.3616366838282248, 2.4977722718418436,
0.3621560205140485, 2.503523126657825,
0.3629350255427841, 2.510888918821839,
0.36386983157726693, 2.518553369529177,
0.3633504948914431, 2.3987040450928383,
0.3636620969029374, 2.389498842285588,
0.36501237228607913, 2.52548963030504,
0.3647527039431673, 2.382490913047082,
0.365272040628991, 2.3769539849966845,
0.36605104565772667, 2.531410707707044,
0.36605104565772667, 2.3704147371426467,
0.3667781170178799, 2.3636099883952255,
0.3674013210408684, 2.537922550563661,
0.3679206577266922, 2.3574287632625994,
0.3689073974297573, 2.543577767531499,
0.36908050965836525, 2.349237418854842,
0.37046540748722856, 2.550645740080681,
0.36994607080140485, 2.3431283881797085,
0.37103667784163474, 2.3372743451591513,
0.3722830858876117, 2.3298670260347594,
0.37436043263090674, 2.557966230106101,
0.3735814276021711, 2.3252205606556697,
0.3754856621168582, 2.3187826833278073,
0.37793808535547035, 2.3114588375884173,
0.38093869731800767, 2.5568118645004425,
0.3805059167464878, 2.30348062762489,
0.3827563757183908, 2.296848897891799,
0.38652774927020617, 2.555181946286472,
0.3852665030332056, 2.290537958434645,
0.3874477171136653, 2.284336279426393,
0.3896808648627075, 2.278673512102122,
0.3920178799489144, 2.2717944696736456,
0.3933162216634738, 2.5524415713849056,
0.39539356840676876, 2.266065215839596,
0.3964322417784163, 2.5465874234982873,
0.39887312420178794, 2.540288328912467,
0.40027533325351206, 2.259923460295093,
0.4011062719508301, 2.534334872865551,
0.40333941969987225, 2.528791652851459,
0.4057432066456851, 2.254282265417772,
0.4060399704661558, 2.5227513677055704,
0.40863665389527454, 2.5167278611295316,
0.41106022509578544, 2.2477785721522254,
0.4114930056673052, 2.510251333167551,
0.4143493574393359, 2.5037244694960212,
0.4159073674968071, 2.243963444960212,
0.41634014806832687, 2.496841061215185,
0.418244382583014, 2.4901170493479223,
0.4196725584690293, 2.4836782731681035,
0.42153351492656443, 2.4774827862511053,
0.4221394077266922, 2.244998922413793,
0.4234748449188104, 2.46965917882405,
0.42546316251596417, 2.46272603406830, 
0.42712503991060025, 2.455714269728116,
0.42785211127075345, 2.24625731515252,
0.42889078464240094, 2.449492436461557,
0.43088157527139204, 2.442264568136605,
0.43252614144316726, 2.4361940815649867,
0.43535364117709663, 2.248626822072404,
0.4340841515006385, 2.4303450721153848,
0.43564216155810975, 2.424043041279841,
0.43740790628991055, 2.4175144997513263,
0.4389659163473818, 2.4095771176410996,
0.4392775183588761, 2.2534553216180373,
0.44052392640485305, 2.402086604774536,
0.4412509977650063, 2.2587909068302388,
0.44161453344508295, 2.396056386770557,
0.44270514048531284, 2.389698906756558,
0.4438476811941251, 2.2646969634173297,
0.44415928320561937, 2.3826670880305043,
0.44499022190293736, 2.376274452917772,
0.4462366299489144, 2.369305753573534,
0.44654823196040866, 2.270963759256189,
0.44717143598339715, 2.3622609913793107,
0.447846573674968, 2.3566561101210213,
0.447846573674968, 2.2772389443799734,
0.44888524704661553, 2.350033818333471,
0.4489371807151979, 2.2837070830570294,
0.4494045837324393, 2.3435184899287136,
0.4502577797162926, 2.336056220988064,
0.45055454353676333, 2.291328948156130,
0.45096259378991055, 2.3291386563328915,
0.45096259378991055, 2.3229815204326925,
0.4511573450470945, 2.3004437064820955,
0.4514819304757343, 2.3173816727453582,
0.45163773148148145, 2.309775387746832])
t2k_future = t2k_future.reshape([-1,2])
t2k_future = orderArray(t2k_future)
t2k_futurebf = [0.399537037037037, 2.399871794871795]

t2k = array([0.4108408402941756,2.4795816733067726,
0.41420347567716315,2.600688156465048,
0.4158130355388321,2.436073886273089,
0.419940413990844,2.6282144150670037,
0.4215654353863917,2.4043824701195216,
0.4256784398130241,2.6515755161173487,
0.4273146199914323,2.385005432814198,
0.4314191607649629,2.6646142701919597,
0.4330623388241478,2.3712423035132195,
0.43687050463651617,2.674856131031429,
0.4388098685249505,2.358203549438609,
0.4426414446652033,2.6832669322709153,
0.44455716181086224,2.3460702643969573,
0.4491664010939389,2.6926838102136896,
0.4503035567201876,2.3373777616805502,
0.4549097698926582,2.6955813111191596,
0.4560492423848399,2.3314016660630204,
0.4606527604275516,2.699927562477363,
0.46179473891757905,2.326149945671858,
0.46639560911351013,2.704817095255342,
0.4675399044694707,2.3221658819268383,
0.47213864693138186,2.708982252806954,
0.47328544828518804,2.3167330677290834,
0.4778822048620138,2.711155378486055,
0.4790302355732541,2.314197754436798,
0.4836263301883847,2.7111553784860556,
0.4847747391634506,2.3127490039840635,
0.48937045551475533,2.711155378486055,
0.4905192427536469,2.3113002535313285,
0.49511458084112614,2.711155378486055,
0.4962641718906474,2.308221658819268,
0.5008587061674968,2.711155378486055,
0.5020085336319092,2.307316189786309,
0.5066028314938676,2.7111553784860547,
0.5077531790710408,2.305324157913799,
0.512346862254282,2.7115175660992383,
0.5134972571144331,2.305505251720391,
0.518090656599805,2.7127852227453815,
0.5192414297237822,2.305324157913798,
0.5238347819261759,2.7127852227453815,
0.5249855550501528,2.3053241579137986,
0.5295786708376558,2.713690691778341,
0.5307290184148284,2.307859471206084,
0.5353233635597652,2.711517566099239,
0.5364724344965258,2.3105758783049613,
0.5410675834520919,2.711155378486055,
0.5422160869931145,2.3123868163708803,
0.5468117087784627,2.7111553784860556,
0.5479600231875724,2.313111191597247,
0.5525558341048339,2.711155378486055,
0.5537032028543787,2.316733067729083,
0.5583001958460958,2.7102499094530956,
0.5594460515403371,2.3216226005070624,
0.5640448412852268,2.7082578775805857,
0.5651891839241654,2.32542557044549,
0.569790148686053,2.703730532415791,
0.5709318907611896,2.3308583846432454,
0.5755353615209231,2.6995653748641795,
0.5766744084663006,2.3370155740673666,
0.5812814727323791,2.691959434987323,
0.5824166897565206,2.344078232524447,
0.587027536660857,2.6845345889170584,
0.5880013106841558,2.3549800796812743,
0.5927744516829426,2.6738500543281414,
0.5938986044901804,2.36834480260775,
0.5985218868177888,2.661173487866713,
0.5994303204934827,2.381872509960159,
0.6042710241398517,2.6419775443679816,
0.6054304973318212,2.401195219123506,
0.6100218636491299,2.616262223831945,
0.614732045336,2.5762663631189526,
0.6160621222681077,2.4820717131474,
0.6168343163464503,2.524568393094289])
t2k = t2k.reshape([-1,2])
t2k = orderArray(t2k)
t2kbf = [0.514, 2.51]

minos = array([0.33318649045521287,2.50275111420254,
0.3370044052863435,2.548945877910635,
0.33524229074889866,2.454123193446170,
0.3387665198237885,2.422239740319963,
0.34493392070484585,2.570000316168876,
0.34361233480176206,2.3908561326223046,
0.3493392070484581,2.3613262230466034,
0.3546255506607929,2.5765871677592056,
0.35594713656387655,2.3308210642244376,
0.3643171806167401,2.5722888518854203,
0.3638766519823788,2.3017806631115234,
0.37312775330396475,2.2734813354973338,
0.3740088105726872,2.5641627848154624,
0.3828193832599118,2.2492069430685246,
0.38370044052863433,2.552687435448854,
0.3925110132158589,2.2312722635583757,
0.39339207048458147,2.5401355310583225,
0.40220264317180615,2.2158495457707144,
0.40308370044052855,2.525669751069705,
0.4118942731277531,2.2043741964041064,
0.4127753303964757,2.510486267731804,
0.42158590308370025,2.194812722635584,
0.42246696035242276,2.494943932719263,
0.4312775330396474,2.188720148388593,
0.43215859030837,2.4784446599076784,
0.441145374449339,2.1845078831439837,
0.44185022026431714,2.4626630904453766,
0.4506607929515418,2.181678540564467,
0.4515418502202641,2.447958076006998,
0.45999999999999985,2.1800191282170185,
0.46123348017621135,2.434090382142782,
0.470044052863436,2.179182387285796,
0.47092511013215865,2.42213656387665,
0.47973568281938317,2.179549143182345,
0.4806167400881056,2.411498535084206,
0.48942731277533014,2.18147092300234,
0.4903083700440527,2.4032528507893685,
0.4991189427312772,2.182914233922813,
0.4999999999999997,2.3958444870686932,
0.5088105726872243,2.1845967792930465,
0.5096916299559471,2.392861960668592,
0.5185022026431717,2.186997028012563,
0.5193832599118942,2.391314840967055,
0.5281938325991187,2.188440338933036,
0.529074889867841,2.394432793035854,
0.5378854625550659,2.19012288430327,
0.5387665198237883,2.397789979554412,
0.5475770925110129,2.192403515797905,
0.5484581497797356,2.4049749172691444,
0.55726872246696,2.195521467866703,
0.5581497797356825,2.41323641000779, 
0.5669603524229072,2.199476740509664,
0.56784140969163,2.4246079505933436,
0.5766519823788544,2.2040300992770274,
0.5775330396475771,2.4363383428535297,
0.5863436123348014,2.210258099192716,
0.5872246696035238,2.451059165735725,
0.5960352422907486,2.2178018885820885,
0.5971806167400877,2.4647188731741245,
0.6057268722466955,2.2280968741437097,
0.6066079295154182,2.4783477014522695,
0.6154185022026428,2.2404253525282973,
0.6162995594713655,2.4912742659612586,
0.6251101321585899,2.256820816558818,
0.6259911894273122,2.503961596020488,
0.6348017621145374,2.277163649010392,
0.6356828193832598,2.514376198806989,
0.6444933920704842,2.3032481082562235,
0.6453744493392067,2.5232357776700463,
0.6533039647577088,2.3314076306772806,
0.6550660792951537,2.525875260839323,
0.6603524229074884,2.3603433142327184,
0.6647577092511013,2.5191846004679297,
0.6656387665198232,2.38943542777649,
0.6696035242290749,2.416856016693716,
0.6713656387665192,2.494510781358683,
0.6722466960352422,2.4445223742174824,
0.6735682819383257,2.4682239740319964])
minos = minos.reshape([-1,2])
minos = orderArray(minos)
minosbf = [sin(0.6949)**2, 2.41]

sk = array([0.38351851851851837,2.7544505831798634,
0.38458333333333317,2.6316758747697953,
0.38583333333333325,2.897483118477591,
0.3854166666666666,2.5267034990791872,
0.3888888888888888,2.4168201350521783,
0.39249999999999996,2.9889502762430933,
0.3983333333333332,2.3457224175456215,
0.4016666666666665,3.0699815837937368,
0.4074999999999998,2.2760756738657286,
0.4108333333333333,3.1536916122551473,
0.41666666666666663,2.2312070986104118,
0.4199999999999998,3.196885986941235,
0.4258333333333332,2.209107651096601,
0.4291666666666666,3.230369998325799,
0.43499999999999994,2.189352084379709,
0.43833333333333324,3.2561526870919133,
0.4441666666666665,2.1876778838104807,
0.44749999999999973,3.260840448685752,
0.4533333333333331,2.1920308052904733,
0.45666666666666644,3.261510128913441,
0.4624999999999998,2.1997321279089217,
0.4658333333333333,3.253139126067303,
0.47166666666666635,2.214799933031977,
0.4749999999999998,3.227021597187342,
0.48083333333333333,2.230872258496567, 
0.48416666666666647,3.201238908421227,
0.4899999999999999,2.2469445839611573,
0.4933333333333333,3.1831575422735616,
0.4991666666666664,2.2620123890842123,
0.5025,3.168089737150509,
0.5083333333333333,2.2777498744349574,
0.5116666666666665,3.1570400133936043,
0.5174999999999996,2.288464758078017,
0.520833333333333,3.1694290976058905,
0.5266666666666663,2.297170601038003,
0.5299999999999997,3.1855014230704812,
0.5358333333333333,2.3048719236564517,
0.5391666666666666,3.2079357106981417,
0.5449999999999999,2.303867403314915,
0.548333333333333,3.243093922651932,
0.5541666666666663,2.303532563201069,
0.5574999999999997,3.2712204922149666,
0.563333333333333,2.3001841620626147,
0.5666666666666667,3.304034823371837,
0.5724999999999998,2.2975054411518485,
0.5816666666666663,2.29516156035493,
0.5849999999999997,3.389753892516319,
0.5908333333333333,2.2961660806964654,
0.5941666666666665,3.429934706177797,
0.5999999999999996,2.3028628829733786,
0.6033333333333333,3.469445839611586,
0.6091666666666662,2.3105642055918283,
0.6125,3.5052737317930664,
0.618333333333333,2.3309894525364125,
0.6216666666666661,3.5220157374853467,
0.6274999999999995,2.3577766616440634,
#0.6308333333333329,3.536079022266868,
0.636666666666666,2.3892516323455544,
0.6399999999999995,3.5190021764607384,
0.642829, 3.48571,
0.6445833333333331,2.445672191528545,
0.6483333333333328,3.4518109269490482,
0.6499999999999995,2.533701657458563,
0.651563,3.42857,
0.6554166666666663,3.370626151012889,
0.6549999999999996,2.6153643777953146,
0.660833333333333,2.693238621415416,
0.6608333333333332,3.295395948434623,
0.6629999999999998,3.2018416206261504,
0.6638333333333333,3.092081031307548,
0.6637499999999998,2.779005524861877,
0.6645833333333331,3.0027624309392276,
0.6656944444444439,2.879066912216081,
0.6649999999999995,2.937384898710863])
sk = sk.reshape([-1,2])
sk = orderArray(sk)
skbf = [0.6,2.8265]

sk2015 = array([0.3943092587948456, 0.0025976001411116335,
0.3945687558497676, 0.002545612906393383,
0.39554324603797897, 0.002492284863296061,
0.39502210294515033, 0.0024557402791814406,
0.3950447702999195, 0.002423325961861572,
0.3952665497596493, 0.0023853881940405722,
0.3960581040915307, 0.00264949979741373,
0.3977033762585241, 0.002344277568959842,
0.39790168126827713, 0.002693570286756474,
0.39931833942463285, 0.0027338798841537717,
0.4017658470558306, 0.0023052194270608214,
0.40144348979543193, 0.0027661903094309483,
0.40454383441621933, 0.00280000725518835,
0.4053027786672624, 0.0022731306953821823,
0.40881347109832505, 0.0028369777108168143,
0.40844838930863425, 0.0022422172317038466,
0.41276946420446287, 0.0022056310417086105,
0.41386573990784303, 0.002871611662616674,
0.41943268032946657, 0.0021702652091055235,
0.4200910525039203, 0.0029040341571929524,
0.4276511044680387, 0.0021446067938411667,
0.42788246135349234, 0.0029305938860133573,
0.43625130493431147, 0.0021314219491504506,
0.4364632728014295, 0.0029451353375425293,
0.44484672839606676, 0.0021250682209197074,
0.44504801825308693, 0.002954051163751723,
0.4534399038556962, 0.0021219291357289505,
0.4536347307066045, 0.0029601541773009296,
0.4620289579780949, 0.0021246835627781705,
0.4622232228284717, 0.002963712265110146,
0.4706170754329411, 0.002128777424427385,
0.47081180861709415, 0.002967136409459362,
0.47920434988699007, 0.0021340767772165935,
0.4794002070722061, 0.0029708284407285786,
0.48779143700752864, 0.002139644016925802,
0.4879886055273181, 0.002974520471997794,
0.49637852412806716, 0.002145211256635010,
0.4965757863146118, 0.002979953768247003,
0.5049656112486057, 0.0021507784963442182,
0.5051603444327588, 0.002989137481376196,
0.513553728703452, 0.002154872357993432,
0.5137422798817588, 0.003002071611385375,
0.5221436258266479, 0.002156421293902657,
0.5223213116613463, 0.0030191579886545356,
0.5307357709519696, 0.0021547555867718945,
0.5308970651045004, 0.0030409323870236784,
0.5393308197467039, 0.002148937632381149,
0.5394678542096264, 0.0030698057887727915,
0.5479237142060676, 0.0021462003775703908,
0.5476483058456225, 0.0030984480521922134,
0.5550448125328591, 0.0031313041539669005,
0.5565124873282006, 0.0021493566349996083,
0.5620492541197024, 0.003166399630118553,
0.5650978884471446, 0.002157334856988807,
0.5698367705952232, 0.0031985254538322684,
0.5736822592317811, 0.002166786457037999,
0.5784096203689646, 0.003224452099461394,
0.5822676603507252, 0.002174764679027198,
0.5869852801453634, 0.003246360441290536,
0.5908524994691379, 0.0021835465617763925,
0.5955689952627131, 0.0032567496455597244,
0.5994299389138862, 0.002202909977865545,
0.6041610467212795, 0.0032552178818889615,
0.6068262522833474, 0.002236042524059064,
0.6127598421862237, 0.0032440421890982374,
0.6126594715674969, 0.0022707447355068073,
0.6192756014146392, 0.002302712280245447,
0.6198045456100831, 0.0032215632383167906,
0.6237372580672209, 0.0031819216164638746,
0.625894998893443, 0.0023300071117081053,
0.625636679363444, 0.003146135014954943,
0.6273016996046681, 0.003110493690583395,
0.6289646591772766, 0.003077799122331836,
0.630556937816378, 0.002364399082136273,
0.6312564661223443, 0.003039314762160607,
0.633886909609872, 0.003000538702898714,
0.6340467831499483, 0.002399643727799360,
0.635584299520596, 0.0024346501945149875,
0.6359520430072483, 0.002467190727787548,
0.637481746009396, 0.0025133703114581293,
0.6371688678246281, 0.0029607861156763114,
0.6394856088599417, 0.0025515977749419744,
0.6395374346756184, 0.002924217833872614,
0.6414358256375337, 0.0028899046104236764,
0.6413335649574956, 0.0025894064075297437,
0.642518449411337, 0.00284946965568561,
0.6430070854567582, 0.00265329245800033,
0.6424852211299141, 0.002617779238527705,
0.643526373947833, 0.0028041718664600247,
0.6435511019712175, 0.0027688107930201687,
0.6431853332919881, 0.0027334462851326203,
0.6432080006467573, 0.0027010319678127514])
sk2015 = sk2015.reshape([-1,2])
sk2015[:,1] *= 10**3
sk2015 = orderArray(sk2015)
sk2015bf = [0.57,2.6]

import os
ic_file = pickle.load(open(os.path.dirname(os.path.realpath(__file__)) + '/IC2014_3years_tracks_only.pckl'))
ic_x = ic_file['90'][:,0]
ic_y = ic_file['90'][:,1]
